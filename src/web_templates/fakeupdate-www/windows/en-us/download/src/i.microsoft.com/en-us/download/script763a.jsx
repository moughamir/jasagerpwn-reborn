(function(a){a.bi={dataConsumers:[],dataRetrievers:[],dataManipulators:[],isInitialized:function(){return this._isInitialized},loadEnabled:function(){if(arguments.length>=1&&typeof arguments[0]=="boolean")this._loadEnabled=arguments[0];return this._loadEnabled},ignoreAttr:function(b){if(typeof b=="string"&&a.trim(b)!="")a.inArray(b,this._ignoreAttr)==-1&&this._ignoreAttr.push(b);else if(typeof b=="object")for(var c=0;c<b.length;c++){b[c]=a.trim(b[c]);a.inArray(b[c],this._ignoreAttr)==-1&&this._ignoreAttr.push(b[c])}},ignoreTextClass:function(c){if(typeof c=="string"&&a.trim(c)!="")for(var d=c.split(/\s+/),b=0;b<d.length;b++)a.inArray(d[b],this._ignoreTextClass)==-1&&this._ignoreTextClass.push(d[b])},baseData:function(){arguments.length>=1&&typeof arguments[0]=="object"&&a.extend(this._baseData,this._objectNametoLower(arguments[0]));return this._baseData},baseLoadData:function(){arguments.length>=1&&typeof arguments[0]=="object"&&a.extend(this._baseLoadData,this._objectNametoLower(arguments[0]));return this._baseLoadData},baseLinkData:function(){arguments.length>=1&&typeof arguments[0]=="object"&&a.extend(this._baseLinkData,this._objectNametoLower(arguments[0]));return this._baseLinkData},_objectNametoLower:function(b){var a={};for(var c in b)a[c.toLowerCase()]=b[c];return a},init:function(d){if(this.isInitialized())return;this._isInitialized=!0;this._ns=this.getNamespacePrefix("urn:schemas-microsoft-com:mscom:bi");this.ignoreAttr(this._ns+":track");var c=window.attachEvent?"click":"mousedown";a("a, area").live(c,a.proxy(function(e){var d=!0,g=a(e.currentTarget),b=g.attr(a.bi._ns+":track");b=b?b.toLowerCase():b;if(b&&(b==="true"||b==="false"))d=b=="true";else{var f=g.parents(":not(table)").filter(function(){var b=a(this).attr(a.bi._ns+":track");b=b?b.toLowerCase():b;return b&&(b==="true"||b==="false")?!0:!1});if(f.length)d=a(f[0]).attr(a.bi._ns+":track").toLowerCase()=="true"}if(d){var c=e.target;if(c.tagName.toLowerCase()=="area")c=a("img[usemap='#"+a(c).parent("map").attr("name")+"']").get(0);this.linkClick(e.currentTarget,c)}},this));for(var b in this.dataRetrievers)try{this.dataRetrievers[b].init()}catch(e){}for(var b in this.dataConsumers)try{this.dataConsumers[b].init(d[b])}catch(e){}this.loadEnabled()&&a(a.proxy(this.recordLoad,this))},record:function(b){b=a.extend({},this._baseData,b);for(var c in this.dataManipulators)try{this.dataManipulators[c].preRecord(b)}catch(d){}for(var c in this.dataConsumers)try{this.dataConsumers[c].record(b)}catch(d){}},recordLoad:function(b){if(b==a)b={};b=a.extend({},this._baseData,this._baseLoadData,b);for(var c in this.dataRetrievers)try{a.extend(b,this.dataRetrievers[c].getLoadData())}catch(d){}for(var c in this.dataManipulators)try{this.dataManipulators[c].preRecordLoad(b)}catch(d){}for(var c in this.dataConsumers)try{this.dataConsumers[c].recordLoad(b)}catch(d){}},linkClick:function(a,b){this.record(this.getLinkData(a,b))},getLinkData:function(c,d){var b=a.extend({},this._baseData,this._baseLinkData);for(var e in this.dataRetrievers)try{a.extend(b,this.dataRetrievers[e].getLinkData(c,d))}catch(f){}return b},getAttrData:function(g,i){var c={},b,f;if(jQuery&&g instanceof jQuery){for(var j=g,h=0,k=j.length;h<k;h++)for(var e=j.get(h).attributes,d=0,l=e.length;d<l;d++){b=e.item(d);f=b.name.toLowerCase();if(f.indexOf(a.bi._ns+":")===0&&(i||a.inArray(f,this._ignoreAttr)<0)){index=f.substring(3,b.name.length);if(c[index]==undefined)c[index]=[];a.inArray(b.value,c[index])<0&&c[index].push(b.value)}}for(var d in c)c[d]=c[d].join(";")}else for(var e=g.attributes,d=0,m=e.length;d<m;d++){b=e.item(d);if(b.name.indexOf(a.bi._ns+":")===0&&(i||a.inArray(b.name,this._ignoreAttr)<0))c[b.name.toLowerCase().substring(3,b.name.length)]=b.value}return c},getText:function(e){var d=a(e).html(),b=a("<div>"+d+"</div>");if(this._ignoreTextClass.length>0){var c="."+this._ignoreTextClass.join(",.");b.find(c).remove()}return a.trim(b.text())},mapData:function(d,b){if(!b)return!1;var e={};for(var a in b){e[a]="";for(var c=0,f=b[a].length;c<f;c++)if(b[a][c].str!==undefined)e[a]+=b[a][c].str;else if(b[a][c].bi&&d&&d[b[a][c].bi]!==undefined){switch(b[a][c].bi){case"uripath":if(d[b[a][c].bi]==""||d[b[a][c].bi]==null||d[b[a][c].bi]==undefined)d[b[a][c].bi]="/";else if(d[b[a][c].bi].substring(0,1)!="/")d[b[a][c].bi]="/"+d[b[a][c].bi];break;case"uriquery":if(d[b[a][c].bi]==""||d[b[a][c].bi]==null||d[b[a][c].bi]==undefined)d[b[a][c].bi]="?"}e[a]+=d[b[a][c].bi]}if(e[a]=="")delete e[a]}return e},isInteractionTypeValid:function(b,a){return!b||!a?!1:a.interactionTypeMap?!b.interactiontype||a.interactionTypeMap[b.interactiontype]!=undefined:!1},getNamespacePrefix:function(e){if(document.namespaces)for(var d=document.namespaces,b=0;b<d.length;b++)if(d[b].urn==e)return d[b].name;for(var c=a("html").get(0).attributes,b=0;b<c.length;b++)if(c[b].value==e)if(c[b].name.indexOf("xmlns:")==0)return c[b].name.substring(c[b].name.indexOf(":")+1)},_isInitialized:!1,_ns:"bi",_loadEnabled:!0,_ignoreAttr:[],_ignoreTextClass:["hpFeat_Arrow"],_baseData:{},_baseLoadData:{interactiontype:0},_baseLinkData:{interactiontype:2}}})(jQuery);(function(a){a.bi.dataRetrievers.attr={getLoadData:function(){var b;b=a("area").filter(function(){return a(this).parent("map").siblings("img").is(":visible")});b=b.add(a("a:visible"));return a.bi.getAttrData(b)},getLinkData:function(b){return a.bi.getAttrData(b)}}})(jQuery);(function(a){a.bi.dataRetrievers.structure={init:function(){a.bi.ignoreAttr(a.bi._ns+":titleflag");a.bi.ignoreAttr(a.bi._ns+":parenttitle");a.bi.ignoreAttr(a.bi._ns+":title");a.bi.ignoreAttr(a.bi._ns+":index");a.bi.ignoreAttr(a.bi._ns+":gridindex");a.bi.ignoreAttr(a.bi._ns+":gridtype");a.bi.ignoreAttr(a.bi._ns+":type");a.bi.baseLoadData({title:document.title,initial:0})},getLinkData:function(c,f){var b={},e=c&&a(c).length&&a(c).get(0).tagName,d=e?a(c).attr("href"):"";b.urifull=d;b.uridomain=e&&a(c)[0].hostname?a(c)[0].hostname:"";b.uripath=e&&a(c)[0].pathname?a(c)[0].pathname:"";b.uripath=b.uripath.length&&b.uripath.indexOf("/")!=0?"/"+b.uripath:b.uripath;b.urihash=d&&d.indexOf("#")>=0?d.substring(d.indexOf("#")):"";if(d.indexOf("#")==0)b.uriquery=window.location.search;else{d=b.urihash?d.substring(0,d.indexOf("#")):d;b.uriquery=d&&d.indexOf("?")>=0?d.substring(d.indexOf("?")):""}b.type=e&&a(c).attr(a.bi._ns+":type")?a.trim(a(c).attr(a.bi._ns+":type")):"";b.index=e&&a(c).attr(a.bi._ns+":index")?a.trim(a(c).attr(a.bi._ns+":index")):"";b.linktitle=a.bi.getText(c);b.title=b.linktitle;var g=c&&a(c).length&&a(c)[0].nodeName?a(c).get(0).nodeName.toLowerCase():"";if(g=="area")b.linktitle=b.title=a(c).attr("alt");else if(b.title==""&&f&&a(f).get(0).nodeName=="IMG")b.title=a(f).attr("alt");a.extend(b,this.getData(c));return b},getData:function(c){var b={};b.parenttitlestructure=this.getTitleStructure(c,null,!0);a.extend(b,this.getIndexGridTypeStructure(c));return b},getIndexGridTypeStructure:function(f){var b={},c=[],d=[],e=[];a(f).parents(":not(table)").each(function(){if(a(this).attr(a.bi._ns+":gridindex")){var b=a(this).attr(a.bi._ns+":gridtype")?a(this).attr(a.bi._ns+":gridtype"):"";c.push(b+" "+a(this).attr(a.bi._ns+":gridindex"))}a(this).attr(a.bi._ns+":index")&&d.push(a(this).attr(a.bi._ns+":index"));a(this).attr(a.bi._ns+":type")&&e.push(a.trim(a(this).attr(a.bi._ns+":type")))});b.parenttypestructure=e.reverse().join(";");b.gridstructure=c.reverse().join(";");b.parentindexstructure=d.reverse().join(";");return b},getIndexStructure:function(c){var b=[],d=!1;a(c).parents(":not(table)").filter(function(){if(a(this).attr(a.bi._ns+":index")){b.push(a(this).attr(a.bi._ns+":index"));return!0}return!1});return b.reverse().join(";")},getGridStructure:function(c){var b=[];a(c).parents(":not(table)").filter(function(){if(a(this).attr(a.bi._ns+":gridindex")){var c=a(this).attr(a.bi._ns+":gridtype")?a(this).attr(a.bi._ns+":gridtype"):"";b.push(c+" "+a(this).attr(a.bi._ns+":gridindex"));return!0}return!1});return b.reverse().join(";")},getTypeStructure:function(c){var b=[];a(c).parents(":not(table)").filter(function(){if(a(this).attr(a.bi._ns+":type")){b.push(a.trim(a(this).attr(a.bi._ns+":type")));return!0}return!1});return b.reverse().join(";")},getTitleStructure:function(c,k,j){var f=[],g=[],b,d,e="";if(!c||!a(c).length||!a(c).get(0).tagName)return"";!j&&f.push(a.trim(a(c).text())||a.trim(a(c).attr("alt")));a(c).attr(a.bi._ns+":parenttitle")&&g.push(a(c));a(c).parents(":not(table)").each(function(){a(this).attr(a.bi._ns+":parenttitle")&&g.push(a(this))});for(var i=0;i<g.length;i++){var h=g[i];e=h.attr(a.bi._ns+":parenttitle");b=h.siblings(":not(table)").filter(function(){return a(this).attr(a.bi._ns+":titleflag")==e}).first();if(b.length==0)b=h.parents(":not(table)").filter(function(){return a(this).attr(a.bi._ns+":titleflag")==e}).first();if(b.length!=0){if(b.attr(a.bi._ns+":title")==e)d=b;else{d=b.find("["+a.bi._ns+'\\:title="'+e+'"]').first();if(d.length==0)d=b.find("*").filter(function(){return a(this).attr(a.bi._ns+":title")==e}).first()}if(d){var l=this.getTitleStructure(d,!0);f=f.concat(l);break}}}return k?f:f.reverse().join(";")}}})(jQuery);(function(a){a.bi.queue={_delay:350,_timerId:null,_queue:[],push:function(a){this._queue.push(a);this._timerId==null&&this._startTimer()},_tryProcess:function(){this._clearTimer();a(":animated").length==0&&this._queue.length>0&&a.bi.record(this._queue.shift());this._queue.length>0&&this._startTimer()},_startTimer:function(){this._clearTimer();this._timerId=window.setTimeout(a.proxy(this._tryProcess,this),this._delay)},_clearTimer:function(){if(this._timerId!=null){window.clearTimeout(this._timerId);this._timerId=null}}}})(jQuery)
